<!DOCTYPE html>
<html class="" lang="en-GB">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="An easy to use and powerful Web Audio API wrapper for controlling audio on the web" />
    <meta name="keywords" content="audio,web-audio-api,javascript,js,audibly" />
    <title>Audibly | An easy to use and powerful Web Audio API wrapper for controlling audio on the web</title>
    <link rel="stylesheet" type="text/css" href="/css/audibly.css">
</head>
<body class="">
    <main>
       
        <section>

            <h1>AudiblyAudioBufferSourceNode</h1>
            <p>Increase playback rate (+0.1) - <a id="buff-playback-inc" href="/#decrease">DO IT</a></p>
            <p>Decrease playback rate (-0.1) - <a id="buff-playback-desc" href="/#increase">DO IT</a></p>
            <p>
                <a id="buff-play" href="/#buff-play">PLAY</a> | <a id="buff-stop" href="/#buff-stop">STOP</a>
            </p>

        </section>

        <section>

        <h1>AudiblyOscillatorNode</h1>
            <p>
                Change wave shape 
                <select id="osc-type">
                    <option selected>sine</option>
                    <option>square</option>
                    <option>sawtooth</option>
                    <option>triangle</option>
                </select>
            </p>
            <p>Increase frequency (+50) - <a id="osc-freq-inc" href="/#increase">DO IT</a></p>
            <p>Decrease frequency (-50) - <a id="osc-freq-dec" href="/#decrease">DO IT</a></p>
            <a id="osc-play" href="/#osc-play">PLAY</a> | <a id="osc-stop" href="/#osc-stop">STOP</a>

        </section>

    </main>
    <script type="text/javascript" src="/js/audibly.js"></script>
    <script type="text/javascript">

        var sources = {};
        var playback = 0.5;
        
        var audibly = new Audibly({
            audio: [
                {
                    id: 1,
                    url: '/audio/music-loop.wav'
                }
            ],
            callback: function() {
                
                for( var id in this.buffers ) {
                    var buffer = this.buffers[id];

                    sources[id] = new AudiblyAudioBufferSourceNode({
                        playbackRate: playback,
                        buffer: buffer,
                        loop: false
                    });

                    sources[id]
                        .connect( 
                            new AudiblyDelayNode({
                                maxDelayTime: 5,
                                delayTime: 0.5
                            }).node
                        )
                        .connect(
                            new AudiblyDelayNode({
                                maxDelayTime: 5,
                                delayTime: 1.5
                            }).node
                        )
                        .connect();

                    // sources[id].connect();
                    // connect source node to convolverGain
                    // var convolverGain = new AudiblyGainNode({
                    //     gain: 40
                    // })
                    // sources[ id ].connect( convolverGain.node )

                    // // connect source node to master gain

                    // var masterGain = new AudiblyGainNode({
                    //     gain: 20
                    // })

                    // sources[ id ].connect(masterGain.node);

                    // // connect master gain to master compression
                    // var masterCompression = new AudiblyDynamicsCompressorNode({
                    //     threshold: -40,
                    //     knee: 0.5,
                    //     ratio: 7,
                    //     attack: 0.5,
                    //     release: 0.5
                    // })
                    // masterGain.connect(masterCompression.node);

                    // // connect master compression to destination
                    // masterCompression.connect();

                    // var conv = new AudiblyConvolverNode({
                    //     buffer: buffer,
                    //     normalise: true
                    // });

                    // console.log(conv);

                    
                    

                    // sources[ id ].connect(conv.node);
                    // conv.connect();
                }

            }
        });

        // AudioBuffer

        document.querySelector('#buff-play').addEventListener('click', function() {
            sources[ 1 ].start(0);
        });

        document.querySelector('#buff-stop').addEventListener('click', function() {
            sources[ 1 ].stop();
        });

        document.querySelector('#buff-playback-inc').addEventListener('click', function() {
            playback += 0.1;
            sources[ 1 ].setPlaybackRate(playback)
        });

        document.querySelector('#buff-playback-desc').addEventListener('click', function() {
            playback -= 0.1;
            sources[ 1 ].setPlaybackRate( playback );
        });

        // Oscillator node

        // var frequency = 22000;

        // var oscNode = new AudiblyOscillatorNode({
        //     frequency: frequency,
        //     type: 'sine'
        // });

        // console.log(oscNode);

        // oscNode.connect();

        // document.querySelector('#osc-play').addEventListener('click', function() {
        //     oscNode.start();
        // });

        // document.querySelector('#osc-stop').addEventListener('click', function() {
        //     oscNode.stop();
        // });

        // document.querySelector('#osc-type').addEventListener('change', function(e) {
        //     oscNode.setType( this.value );
        // });

        // document.querySelector('#osc-freq-inc').addEventListener('click', function() {
        //     frequency += 50;
        //     oscNode.setFrequency(frequency)
        // });

        // document.querySelector('#osc-freq-dec').addEventListener('click', function() {
        //     frequency -= 50;
        //     oscNode.setFrequency( frequency );
        // });

        // Biquad filter node

        // var biquad = new AudiblyBiquadFilterNode({
        //     frequency: frequency,
        //     type: 'lowpass',
        //     detune: 18000,
        //     Q: 3,
        //     gain: 300
        // });

        // biquad.connect();

        // console.log(biquad);


        // var delay = new AudiblyDelayNode({
        //     maxDelayTime: 5,
        //     delayTime: 0.5
        // });

        // delay.setDelayTime(4);

        // console.log(delay);

        // var dynamics = new AudiblyDynamicsCompressorNode({
            // threshold: -40,
            // knee: 0.5,
            // ratio: 7,
            // attack: 0.5,
            // release: 0.5
        // });

        // console.log(dynamics);

        // var gain = new AudiblyGainNode({
        //     gain: 40
        // });

        // console.log(gain);

        // var panner = new AudiblyStereoPannerNode({
        //     pan: 0.8
        // });

        // console.log(panner);

        // var wave = new AudiblyWaveShaperNode({
        //     curve: new Float32Array(2),
        //     oversample: '4x'
        // });

        // console.log(wave);

    </script>
</body>
</html>
